<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        Node.js - Day 3 - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/styles/github-gist.min.css" integrity="sha256-tAflq+ymku3Khs+I/WcAneIlafYgDiOQ9stIHH985Wo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @import url(https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400italic,600,600italic,300italic,300|Source+Serif+Pro|Source+Code+Pro:400,300,500&subset=latin,latin-ext);.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif;font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{padding:0 1em;color:#777;border-left:.25em solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:0;padding-top:.2em;padding-bottom:.2em;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\A0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.markdown-body kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid #ccc;border-bottom-color:#bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0 none}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,sans-serif;padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram{text-align:center;background-color:inherit;border-radius:0;white-space:inherit}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg{max-width:100%;height:100%}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p,.markdown-body .alert>ul{margin-bottom:0}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.MJX_Assistive_MathML{display:none}.ui-infobar{position:relative;z-index:2;max-width:758px;margin-top:25px;margin-bottom:-25px;color:#777}.ui-toc{position:fixed;bottom:20px;z-index:10000}.ui-toc-label{opacity:.3;background-color:#ccc;border:none;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff;transition:opacity .2s}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;transition:opacity .2s}.ui-toc-dropdown{margin-top:23px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child > ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,Hiragino Kaku Gothic Pro,\\30D2\30E9\30AE\30CE\89D2\30B4 Pro W3,Osaka,Meiryo,\\30E1\30A4\30EA\30AA,MS Gothic,"\FF2D\FF33   \30B4\30B7\30C3\30AF",sans-serif}.ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,"\FF2D\FF33   \FF30\30B4\30B7\30C3\30AF",sans-serif}.markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,PingFang TC,Microsoft JhengHei,\\5FAE\8EDF\6B63\9ED1,sans-serif}.ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,\\5FAE\8EDF\6B63\9ED1UI,sans-serif}.markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,PingFang SC,Microsoft YaHei,\\5FAE\8F6F\96C5\9ED1,sans-serif}.ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,\\5FAE\8F6F\96C5\9ED1UI,sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:3px;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:contain}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}small span{line-height:22px}small .dropdown{display:inline-block}small .dropdown a:focus,small .dropdown a:hover{text-decoration:none}.unselectable{-moz-user-select:none;-webkit-user-select:none;-o-user-select:none;user-select:none}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;font-family:Source Sans Pro,Helvetica,Arial,sans-serif;letter-spacing:.025em}.focus,:focus{outline:none!important}::-moz-focus-inner{border:0!important}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid"><h1 id="nodejs-day-3" style=""><a class="anchor hidden-xs" href="#nodejs-day-3" title="nodejs-day-3"><span class="octicon octicon-link"></span></a>Node.js - Day 3</h1><h2 id="promises" style=""><a class="anchor hidden-xs" href="#promises" title="promises"><span class="octicon octicon-link"></span></a>Promises</h2><p>So if you’ve had prior programming experience, the concept of functions was probably familiar to you, and if not, it should’ve been fairly understandable. Today, though, we’ll be focusing on promises, which is another method of handling asynchronicity in Node.js. This is a little trickier to understand.</p><div class="alert alert-info">
<p>You might see similar things in other languages referenced as “Futures” and “Deferred”. These are quite similar to those found here.</p>
</div><h3 id="what-are-they" style=""><a class="anchor hidden-xs" href="#what-are-they" title="what-are-they"><span class="octicon octicon-link"></span></a>What are they?</h3><p>So the idea of a promise is that a function can return a temporary value that basically says: <em>I’m not ready to return a value for right now so I’ll give you something that will eventually be what you want.</em></p><p>Now what would something like this look like? This might not be how you would use one normally, but this kind of shows the thought process above.</p><p>We’re going to make a short script that’ll fetch this file from here: <a href="https://get.docker.com" target="_blank">https://get.docker.com</a>. This is the installer to get Docker on Linux.</p><pre><code class="javascript hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span></div><div class="code"><span class="hljs-comment">// Here we're importing a promise-based http request function</span>
<span class="hljs-keyword">const</span> request = <span class="hljs-built_in">require</span>(<span class="hljs-string">'request-promise-native'</span>);

<span class="hljs-comment">// Let's get content from the website, this might take a little bit</span>
<span class="hljs-keyword">let</span> futureResponse = request.get(<span class="hljs-string">'https://get.docker.com'</span>);

<span class="hljs-comment">// Okay so when this is done loading, we'll get the real response</span>
<span class="hljs-comment">// value and print it out</span>
futureResponse.then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">response</span>) </span>{
    <span class="hljs-built_in">console</span>.log(response);
});
</div></div></code></pre><p>Let’s try and run that. So go ahead and put this in a file.</p><p>Now you might see that dependency at the top, to get this run:</p><pre><code class="sh hljs">$ npm <span class="hljs-keyword">install</span> request request-promise-<span class="hljs-keyword">native</span>
</code></pre><p>When we run this file we should be getting something like this:</p><p><img src="https://i.imgur.com/h6cgy7n.png" alt=""></p><p>So in this example we’re storing the promise in the variable <code>futureResponse</code>. The <code>.then(...)</code> part is capturing the value of the reponse when the promise <em>resolves</em>. The inner function there is accepting that value and then printing it out. If this isn’t making that much sense, don’t worry! This topic is one of the harder things we’ll talk about.</p><p>Now normally you don’t assign promises to a variable and so it’s more likely you’d see the above written like one of the following:</p><pre><code class="javascript hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span>
<span data-linenumber="23"></span></div><div class="code"><span class="hljs-keyword">const</span> request = <span class="hljs-built_in">require</span>(<span class="hljs-string">'request-promise-native'</span>);

<span class="hljs-comment">// We're putting then .then on the same line</span>
request.get(<span class="hljs-string">'https://get.docker.com'</span>).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">response</span>) </span>{
    <span class="hljs-built_in">console</span>.log(response);
});

<span class="hljs-comment">// Let's put the .then on a it's own indented line</span>
<span class="hljs-comment">// (This is common when adding many .then's which you'll see later.)</span>
request.get(<span class="hljs-string">'https://get.docker.com'</span>)
    .then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">response</span>) </span>{
        <span class="hljs-built_in">console</span>.log(response);
    });

<span class="hljs-comment">// Let's use our arrow functions instead</span>
request.get(<span class="hljs-string">'https://get.docker.com'</span>)
    .then(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(response);
    });

<span class="hljs-comment">// Finally let's put this .then on just one line</span>
request.get(<span class="hljs-string">'https://get.docker.com'</span>)
    .then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(response));
</div></div></code></pre><p>All of the above are just slight variations. The last one might look a little weird but it’s nice when you start putting a lot of <code>.then</code>'s after a promise. In the average UAV Austin case, you’ll see the 3rd form quite a bit.</p><h3 id="what-is-“promise-chaining”" style=""><a class="anchor hidden-xs" href="#what-is-“promise-chaining”" title="what-is-“promise-chaining”"><span class="octicon octicon-link"></span></a>What is “promise chaining”?</h3><p>So promise chaining, in short, is when we keep adding more <code>.then(...)</code>'s after each other. So in the example above, if we wanted a separate operation after printing the response we could do this:</p><pre><code class="javascript hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span></div><div class="code"><span class="hljs-keyword">const</span> request = <span class="hljs-built_in">require</span>(<span class="hljs-string">'request-promise-native'</span>);

<span class="hljs-comment">// Let's print it and then print something else</span>
request.get(<span class="hljs-string">'https://get.docker.com'</span>)
    .then(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(response);
    })
    .then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Okay I did it!'</span>);
    });
</div></div></code></pre><p>Now sure, we could’ve put those two <code>console.log()</code>'s in the same code block, but this is just an example. We could do this forever, and have more functions that will run after all the ones above are finished.</p><p>You can see the second function didn’t have access to <code>response</code>. How do we pass it?</p><p>In promises the return value in then <code>.then(...)</code> is passed to the next <code>.then(...)</code>, so we could do this:</p><pre><code class="javascript hljs"><div class="wrapper"><div class="gutter linenumber continue"><span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span></div><div class="code">request.get(<span class="hljs-string">'https://get.docker.com'</span>)
    .then(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(response);
        
        <span class="hljs-keyword">return</span> response;
    })
    .then(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'It was '</span> + response.length + <span class="hljs-string">' characters long!'</span>);
    });
</div></div></code></pre><p>You can see the response string for the first <code>.then(...)</code> is now available to the next! Most of the time we would modify the response for the next function to accept, but this is an example.</p><p>So when you return a string in the <code>.then(...)</code>, the next function receives the string. If a <code>.then(...)</code> returns a new promise, the next one receives the value that new promise resolves with.</p><p>Take this for example, we’re going to get two different webpages now.</p><pre><code class="javascript hljs"><div class="wrapper"><div class="gutter linenumber continue"><span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span>
<span data-linenumber="23"></span>
<span data-linenumber="24"></span>
<span data-linenumber="25"></span>
<span data-linenumber="26"></span>
<span data-linenumber="27"></span></div><div class="code">request.get(<span class="hljs-string">'https://google.com'</span>)
    .then(<span class="hljs-function">(<span class="hljs-params">res1</span>) =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Google\'s page is '</span> + res1.length + <span class="hljs-string">'characters long.'</span>)
    })
    .then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> request.get(<span class="hljs-string">'https://bing.com'</span>))
    .then(<span class="hljs-function">(<span class="hljs-params">res2</span>) =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Bing\'s page is '</span> + res2.length + <span class="hljs-string">'long.'</span>);
    });
</div></div></code></pre><div class="alert alert-info">
<p>Remember!</p>
<p><code>() =&gt; expression</code> is shorthand for <code>() =&gt; { return expression }</code>.</p>
</div><p>So first we’re getting Google’s homepage, we then print how long the HTML is, and then we’re getting Bing’s and also printing it out afterwards.</p><h3 id="what-if-an-error-happens" style=""><a class="anchor hidden-xs" href="#what-if-an-error-happens" title="what-if-an-error-happens"><span class="octicon octicon-link"></span></a>What if an error happens?</h3><p>So promises handle errors differently than synchonous code and callback functions do. To capture the error thrown. we use <code>.catch(...)</code>.</p><p>So to recap real fast, this is how regular sychronous code handles errors:</p><pre><code class="javascript hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span></div><div class="code"><span class="hljs-keyword">try</span> {
    <span class="hljs-built_in">require</span>(<span class="hljs-string">'doesn\'t exist'</span>);
    
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'I will never get to print :('</span>);
} <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-built_in">console</span>.error(err);
    <span class="hljs-comment">// We can do whatever here</span>
}
</div></div></code></pre><p>Callbacks do it a little differently:</p><pre><code class="javascript hljs"><div class="wrapper"><div class="gutter linenumber continue"><span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span>
<span data-linenumber="23"></span>
<span data-linenumber="24"></span></div><div class="code"><span class="hljs-comment">// Here's a makeshift callback function which will pass an error</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doAThing</span>(<span class="hljs-params">cb</span>) </span>{
    <span class="hljs-keyword">let</span> doIFail = <span class="hljs-literal">true</span>;
    
    <span class="hljs-keyword">if</span> (doIFail) {
        cb(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'I failed :/'</span>));
        <span class="hljs-keyword">return</span>;
    }
    
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'This will not happen'</span>);
}

doAThing(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.err(err);
    <span class="hljs-comment">// Handling this error</span>
});
</div></div></code></pre><p>Let’s try using <code>.catch(...)</code>.</p><pre><code class="javascript hljs"><div class="wrapper"><div class="gutter linenumber continue"><span data-linenumber="25"></span>
<span data-linenumber="26"></span>
<span data-linenumber="27"></span>
<span data-linenumber="28"></span>
<span data-linenumber="29"></span>
<span data-linenumber="30"></span>
<span data-linenumber="31"></span>
<span data-linenumber="32"></span>
<span data-linenumber="33"></span></div><div class="code"><span class="hljs-comment">// Obviously ".legos" is not a thing</span>
<span class="hljs-comment">// This shouldn't work</span>
request.get(<span class="hljs-string">'http://i-like-stepping-on.legos'</span>)
    .then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Really?'</span>))
    .catch(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Yeah man, no one likes that'</span>);
        
        <span class="hljs-built_in">console</span>.error(err);
    });
</div></div></code></pre><p>So once that error happens in the first promise, it’ll glide right over the <code>.then(...)</code> and pass the error into the <code>.catch(...)</code>. You can keep chaining more <code>.then(...)</code>'s and <code>.catch(...)</code>'s afterwards if you want.</p><p>I haven’t mentioned something yet though, you can pass a second argument into <code>.then(...)</code>!</p><p>Another way to write the above is this:</p><pre><code class="javascript hljs"><div class="wrapper"><div class="gutter linenumber continue"><span data-linenumber="34"></span>
<span data-linenumber="35"></span>
<span data-linenumber="36"></span>
<span data-linenumber="37"></span>
<span data-linenumber="38"></span>
<span data-linenumber="39"></span>
<span data-linenumber="40"></span>
<span data-linenumber="41"></span></div><div class="code">request.get(<span class="hljs-string">'http://i-like-stepping-on.legos'</span>)
    .then(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Really?'</span>);
    }, (err) =&gt; {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Yeah man, no one likes that'</span>);
        
        <span class="hljs-built_in">console</span>.error(err);
    });
</div></div></code></pre><p>The second function passed into <code>.then(...)</code> is for errors. All <code>.catch(...)</code> really is, is syntantic sugar for <code>.then(undefined, ...)</code>.</p><p>Most people prefer using <code>.catch(...)</code> though as it’s a little nicer and more convenient.</p><div class="alert alert-danger">
<p>If you’re dealing with a promise that might reject, i.e. give an error, you should have a <code>.catch(...)</code>. If you don’t, you’ll get a lovely warning pop up.</p>
<p>Sooner or later, Node.js will throw an actual error and kill the script if you don’t handle your rejections. In Node.js 7+, there’s an deprecation warning for this. See <a href="http://blog.lholmquist.org/promise-rejection-handling/" target="_blank">here</a> for some nice boring details.</p>
</div><h4 id="whatabout-finally"><a class="anchor hidden-xs" href="#whatabout-finally" title="whatabout-finally"><span class="octicon octicon-link"></span></a>Whatabout finally?</h4><p>Finally doesn’t have a direct equivalent. Some other promise libraries do however.</p><p>To get the same behavior though, the following still works as a puesdo try / catch / finally:</p><pre><code class="javascript hljs"><div class="wrapper"><div class="gutter linenumber continue"><span data-linenumber="42"></span>
<span data-linenumber="43"></span>
<span data-linenumber="44"></span>
<span data-linenumber="45"></span>
<span data-linenumber="46"></span>
<span data-linenumber="47"></span>
<span data-linenumber="48"></span>
<span data-linenumber="49"></span>
<span data-linenumber="50"></span>
<span data-linenumber="51"></span>
<span data-linenumber="52"></span></div><div class="code">doAsyncThingWithPromise()
    .then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        <span class="hljs-comment">// We'd go here if an error didn't pop up</span>
    })
    .catch(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
        <span class="hljs-comment">// We'll handle our error here if it happened in either the</span>
        <span class="hljs-comment">// doAsyncThing function or the .then(...) above</span>
    })
    .then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        <span class="hljs-comment">// This block will run after because of chaining!</span>
    })
</div></div></code></pre><h4 id="more-on-catching"><a class="anchor hidden-xs" href="#more-on-catching" title="more-on-catching"><span class="octicon octicon-link"></span></a>More on catching</h4><p>See here for good explanation if you’d like:<br>
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/catch" target="_blank">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/catch</a></p><h3 id="how-do-i-make-my-own-promises" style=""><a class="anchor hidden-xs" href="#how-do-i-make-my-own-promises" title="how-do-i-make-my-own-promises"><span class="octicon octicon-link"></span></a>How do I make my own promises?</h3><p>So in the above example, the promise came from an external function. Somewhere along the line, the intitial promise has to be made. I’ll show you 3 ways of doing this:</p><h4 id="making-a-promise-by-the-constructor"><a class="anchor hidden-xs" href="#making-a-promise-by-the-constructor" title="making-a-promise-by-the-constructor"><span class="octicon octicon-link"></span></a>Making a promise by the constructor</h4><p>This is the more format way to make a promise, I’ll show you the syntax real fast.</p><pre><code class="javascript hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span></div><div class="code"><span class="hljs-keyword">let</span> p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-comment">// ...do your thing</span>
});
</div></div></code></pre><p>So we’re passing in a function to the <code>Promise</code> constructor with has two functions in the arguments that you can call. You call the <code>resolve</code> function with the value you want to pass to the <code>.then(...)</code> function, and <code>reject</code> to send the error to the <code>.catch(...)</code> or the second part in <code>.then(..., handleErr)</code>.</p><p>You’re normally not going to have to make your own promise <em>unless</em> you’re wrapping a callback into a promise, which is a pretty common thing, that goes like this:</p><pre><code class="javascript hljs"><div class="wrapper"><div class="gutter linenumber continue"><span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span>
<span data-linenumber="23"></span>
<span data-linenumber="24"></span>
<span data-linenumber="25"></span>
<span data-linenumber="26"></span>
<span data-linenumber="27"></span>
<span data-linenumber="28"></span>
<span data-linenumber="29"></span>
<span data-linenumber="30"></span>
<span data-linenumber="31"></span>
<span data-linenumber="32"></span>
<span data-linenumber="33"></span>
<span data-linenumber="34"></span>
<span data-linenumber="35"></span></div><div class="code"><span class="hljs-comment">// This function will multiply a number by 10, unless it's 0</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">callbackFunction</span>(<span class="hljs-params">input, cb</span>) </span>{
    <span class="hljs-comment">// To make this asynchronous, we'll do this in the near future!</span>
    process.nextTick(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        <span class="hljs-keyword">if</span> (input === <span class="hljs-number">0</span>) {
            cb(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'input can\'t be 0'</span>))
        } <span class="hljs-keyword">else</span> {
            cb(<span class="hljs-literal">null</span>, input * <span class="hljs-number">10</span>);
        }
    });
}

<span class="hljs-comment">// Let's make that work with promises</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">wrapped</span>(<span class="hljs-params">input</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
        callbackFunction(input, (err, output) =&gt; {
            <span class="hljs-keyword">if</span> (err) reject(err);
            <span class="hljs-keyword">else</span> resolve(output);
        });
    });
}

<span class="hljs-comment">// This'll print 100</span>
callbackFunction(<span class="hljs-number">10</span>, (err, output) =&gt; {
    <span class="hljs-built_in">console</span>.log(output);
});

<span class="hljs-comment">// This'll also print 100</span>
wrapped(<span class="hljs-number">10</span>).then(<span class="hljs-built_in">console</span>.log);

<span class="hljs-comment">// We can also handle errors like this too now</span>
wrapped(<span class="hljs-number">0</span>).catch(<span class="hljs-built_in">console</span>.error);
</div></div></code></pre><p><em>Normally when you wrap functions you’re wrapping other libraries, not your own.</em></p><h4 id="instant-promises"><a class="anchor hidden-xs" href="#instant-promises" title="instant-promises"><span class="octicon octicon-link"></span></a>Instant Promises</h4><p>Sometimes you want a promise to start a promise chain but you don’t have anywhere to start. You could make one like the above but there’s another way.</p><p>To make a promise that resolves right away, do this:</p><pre><code class="javascript hljs"><div class="wrapper"><div class="gutter linenumber continue"><span data-linenumber="36"></span>
<span data-linenumber="37"></span>
<span data-linenumber="38"></span>
<span data-linenumber="39"></span>
<span data-linenumber="40"></span>
<span data-linenumber="41"></span>
<span data-linenumber="42"></span>
<span data-linenumber="43"></span></div><div class="code"><span class="hljs-built_in">Promise</span>.resolve(<span class="hljs-string">'This is a nice string you got there'</span>)
    .then(<span class="hljs-function">(<span class="hljs-params">str</span>) =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(str);
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'It would be a shame if something happened to it'</span>);
    });
    
<span class="hljs-built_in">Promise</span>.resolve()
    .then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'No arguments are needed up there'</span>));
</div></div></code></pre><p>Normally you’ll need <code>Promise.resolve()</code> for some weirder corner cases which I don’t feel the need to go into. A similar concept exists for promises that reject right away:</p><pre><code class="javascript hljs"><div class="wrapper"><div class="gutter linenumber continue"><span data-linenumber="44"></span>
<span data-linenumber="45"></span></div><div class="code"><span class="hljs-built_in">Promise</span>.reject(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">':/'</span>))
    .then(<span class="hljs-built_in">console</span>.err);
</div></div></code></pre><h3 id="what-else-can-i-do-with-them" style=""><a class="anchor hidden-xs" href="#what-else-can-i-do-with-them" title="what-else-can-i-do-with-them"><span class="octicon octicon-link"></span></a>What else can I do with them?</h3><p>There are two other functions I haven’t mentioned here: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all" target="_blank"><code>Promise.all()</code></a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/race" target="_blank"><code>Promise.race()</code></a>. Click those two if you’d like to know what they do. <code>Promise.all()</code> is normally the more useful of the two.</p><p>For the most part, this all is what you can do with standard Node.js promises.</p><h3 id="can-i-get-more-info-on-this" style=""><a class="anchor hidden-xs" href="#can-i-get-more-info-on-this" title="can-i-get-more-info-on-this"><span class="octicon octicon-link"></span></a>Can I get more info on this?</h3><p>There are a great deal of tutorials on Node.js promises as they are a pretty hot topic. I have here some additional sources if you’d like to check them out:</p><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises" target="_blank">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises</a></li>
<li><a href="https://strongloop.com/strongblog/promises-in-node-js-an-alternative-to-callbacks/" target="_blank">https://strongloop.com/strongblog/promises-in-node-js-an-alternative-to-callbacks/</a></li>
</ul><div class="alert alert-warning">
<p>When you look up this topic you may get confused when people start bringing up different promise libraries.<br>
In the beginning of Node.js there was not native support, and so in those dark times it was a battleground for which library to use (and those libraries are definitely still in use today). Most of them work the same way, so don’t get too confused when Q promises are mentioned, or Bluebird, and so on. Some will have additional features, but we’re going to stick to <code>.then(...)</code> and <code>.catch(...)</code> for the most part.</p>
</div><hr><h2 id="practice" style=""><a class="anchor hidden-xs" href="#practice" title="practice"><span class="octicon octicon-link"></span></a>Practice</h2><p>Here are some promise-based practice problems. These’ll be a little trickier than practice from other sections given the nature of promises.</p><div class="alert alert-warning">
<p><span style="float:left"><img alt=":unamused:" class="emoji" src="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/images/basic/unamused.png" title=":unamused:"></span></p>
<p><span style="float:right"><img alt=":unamused:" class="emoji" src="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/images/basic/unamused.png" title=":unamused:"></span></p>
<center>Moderate</center> 
<br>
<p>See the function <a href="https://nodejs.org/api/fs.html#fs_fs_mkdir_path_mode_callback" target="_blank"><code>fs.mkdir()</code></a>.</p>
<p>This simply makes a directory as <code>mkdir</code> would on the command line. Here’s some example usage:</p>
<pre><code class="javascript hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span></div><div class="code"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);

fs.mkdir(<span class="hljs-string">'cool_directory'</span>, (err) =&gt; {
    <span class="hljs-keyword">if</span> (err) <span class="hljs-built_in">console</span>.log(err);
    <span class="hljs-keyword">else</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'created'</span>);
});
</div></div></code></pre>
<p>So we have two problems here:</p>
<ol>
<li>This function doesn’t have a promise variant</li>
<li>This is not recursive, i.e. <code>'cool/directory/man'</code> would give an error.</li>
</ol>
<p>Make a recursive version of the function that also returns a promise. (I’d suggest wrapping the orginal in a promise first.)</p>
<p>You’ll end up with functionality like this:</p>
<pre><code class="javascript hljs"><div class="wrapper"><div class="gutter linenumber continue"><span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span></div><div class="code"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">myMkdir</span>(<span class="hljs-params">path, mode</span>) </span>{
    <span class="hljs-comment">// ...</span>
    <span class="hljs-comment">// note that mode is optional</span>
}

myMkdir(<span class="hljs-string">'cool/directory/man'</span>)
    .then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'created'</span>))
    .catch(<span class="hljs-built_in">console</span>.error);
</div></div></code></pre>
</div><div class="alert alert-danger">
<p><span style="float:left"><img alt=":sweat:" class="emoji" src="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/images/basic/sweat.png" title=":sweat:"></span></p>
<p><span style="float:right"><img alt=":sweat:" class="emoji" src="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/images/basic/sweat.png" title=":sweat:"></span></p>
<center>Hard</center> 
<br>
<p>Alright, so we’re going to take this idea of getting the HTML of the different search engines to the next level.</p>
<p>We want to rank search engines by how long their homepages are in terms of their HTML. We’ll look at the following:</p>
<ul>
<li><a href="http://google.com" target="_blank">google.com</a></li>
<li><a href="http://bing.com" target="_blank">bing.com</a></li>
<li><a href="http://yahoo.com" target="_blank">yahoo.com</a></li>
<li><a href="http://ask.com" target="_blank">ask.com</a></li>
<li><a href="http://duckduckgo.com" target="_blank">duckduckgo.com</a></li>
<li><a href="http://scholar.google.com" target="_blank">scholar.google.com</a></li>
</ul>
<p>First request Google’s, then Bing’s, and so on. Afterwards, print out a list showing the order of search engines from shortest to longest.</p>
<p><a href="https://gist.github.com/anonymous/0983d32be6d7eafbfad57040f462aa80" target="_blank">Some hints</a></p>
</div></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav"><li class=""><a href="#nodejs-day-3">Node.js - Day 3</a><ul class="nav"><li class=""><a href="#promises">Promises</a><ul class="nav"><li class=""><a href="#what-are-they">What are they?</a></li><li class=""><a href="#what-is-“promise-chaining”">What is “promise chaining”?</a></li><li class=""><a href="#what-if-an-error-happens">What if an error happens?</a></li><li class=""><a href="#how-do-i-make-my-own-promises">How do I make my own promises?</a></li><li class=""><a href="#what-else-can-i-do-with-them">What else can I do with them?</a></li><li class=""><a href="#can-i-get-more-info-on-this">Can I get more info on this?</a></li></ul></li><li class=""><a href="#practice">Practice</a></li></ul></li></ul></div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;"  >
        <div class="toc"><ul class="nav"><li class=""><a href="#nodejs-day-3">Node.js - Day 3</a><ul class="nav"><li class=""><a href="#promises">Promises</a><ul class="nav"><li class=""><a href="#what-are-they">What are they?</a></li><li class=""><a href="#what-is-“promise-chaining”">What is “promise chaining”?</a></li><li class=""><a href="#what-if-an-error-happens">What if an error happens?</a></li><li class=""><a href="#how-do-i-make-my-own-promises">How do I make my own promises?</a></li><li class=""><a href="#what-else-can-i-do-with-them">What else can I do with them?</a></li><li class=""><a href="#can-i-get-more-info-on-this">Can I get more info on this?</a></li></ul></li><li class=""><a href="#practice">Practice</a></li></ul></li></ul></div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
